{
    "id": "aec65f88-2e40-480c-bb58-ddf248beebc8",
    "connectorTypeString": "XSUAA",
    "accessMode": "WRITE",
    "destinationName": "",
    "relatedSystems": [
        "Local Directory SAP Provisioning"
    ],
    "gitAllowedExpressions": [],
    "gitDisallowedExpressions": [],
    "emailSubscribers": [],
    "name": "BTP CF provisioning target",
    "tenantId": "teched2025-00",
    "state": "ENABLED",
    "systemManagementType": "CUSTOMER_MANAGED",
    "properties": {
        "xsuaa.group.unique.attribute": "id",
        "Authentication": "BasicAuthentication",
        "ips.application.id": "",
        "ips.failed.request.retry.attempts": "2",
        "ips.failed.request.retry.attempts.interval": "50",
        "ips.trace.failed.entity.content": "true",
        "OAuth2TokenServiceURL": "",
        "ProxyType": "Internet",
        "scim.group.unique.attribute": "displayName",
        "Type": "HTTP",
        "URL": "https://api.authentication.eu10.hana.ondemand.com",
        "User": "",
        "xsuaa.group.prefix": "TECHED_BTP_",
        "xsuaa.origin": "sap.custom",
        "xsuaa.user.unique.attribute": "userName,origin"
    },
    "encryptedProperties": {
        "Password": null
    },
    "automaticOutboundCertificateRenew": false,
    "transformationChanged": true,
    "readTransformationChanged": false,
    "writeTransformationChanged": false,
    "fromImport": false,
    "transformation": {
        "user": {
            "condition": "isValidEmail($.emails[0].value) && (('%xsuaa.group.prefix%' === 'null') || ($.groups[?(@.display =~ /%xsuaa.group.prefix%.*/)] empty false))",
            "mappings": [
                {
                    "constant": "xsuaa-dummy-value",
                    "targetPath": "$.id",
                    "scope": "createEntity"
                },
                {
                    "sourceVariable": "entityIdTargetSystem",
                    "targetPath": "$.id"
                },
                {
                    "sourcePath": "$.userName",
                    "targetPath": "$.userName"
                },
                {
                    "sourcePath": "$.name",
                    "optional": true,
                    "targetPath": "$.name"
                },
                {
                    "sourcePath": "$.active",
                    "optional": true,
                    "targetPath": "$.active",
                    "defaultValue": true
                },
                {
                    "constant": true,
                    "targetPath": "$.active",
                    "scope": "createEntity"
                },
                {
                    "sourcePath": "$.verified",
                    "optional": true,
                    "targetPath": "$.verified"
                },
                {
                    "sourcePath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['mailVerified']",
                    "optional": true,
                    "targetPath": "$.verified"
                },
                {
                    "constant": true,
                    "targetPath": "$.verified",
                    "scope": "createEntity"
                },
                {
                    "constant": "%xsuaa.origin%",
                    "targetPath": "$.origin"
                },
                {
                    "sourcePath": "$.phoneNumbers",
                    "preserveArrayWithSingleElement": true,
                    "optional": true,
                    "targetPath": "$.phoneNumbers"
                },
                {
                    "sourcePath": "$.emails",
                    "preserveArrayWithSingleElement": true,
                    "targetPath": "$.emails"
                },
                {
                    "condition": "$.emails[?(@.primary == true)].value == []",
                    "constant": true,
                    "targetPath": "$.emails[0].primary"
                },
                {
                    "constant": "urn:scim:schemas:core:1.0",
                    "targetPath": "$.schemas[0]"
                }
            ]
        },
        "group": {
            "condition": "isAttributeWithOptionalPrefix($.displayName, xsuaa.group.prefix) && isAttributeWithOptionalPrefix($['urn:sap:cloud:scim:schemas:extension:custom:2.0:Group']['name'], xsuaa.group.prefix) && (isRegularGroup() || isApplicationSpecificGroup())",
            "skipOperations": [
                "create"
            ],
            "mappings": [
                {
                    "sourcePath": "$.displayName",
                    "targetPath": "$.displayName",
                    "targetVariable": "entityIdTargetSystem",
                    "functions": [
                        {
                            "function": "replaceFirstString",
                            "condition": "isAttributeWithMandatoryPrefix(@, xsuaa.group.prefix)",
                            "regex": "%xsuaa.group.prefix%",
                            "replacement": ""
                        }
                    ]
                },
                {
                    "sourcePath": "$.displayName",
                    "targetPath": "$.id",
                    "targetVariable": "entityIdTargetSystem",
                    "functions": [
                        {
                            "function": "replaceFirstString",
                            "condition": "isAttributeWithMandatoryPrefix(@, xsuaa.group.prefix)",
                            "regex": "%xsuaa.group.prefix%",
                            "replacement": ""
                        }
                    ]
                },
                {
                    "sourcePath": "$.description",
                    "optional": true,
                    "targetPath": "$.description"
                },
                {
                    "constant": "urn:scim:schemas:core:1.0",
                    "targetPath": "$.schemas[0]"
                },
                {
                    "sourcePath": "$.members",
                    "preserveArrayWithSingleElement": true,
                    "optional": true,
                    "targetPath": "$.members",
                    "functions": [
                        {
                            "function": "resolveEntityIds"
                        }
                    ]
                },
                {
                    "constant": "USER",
                    "preserveArrayWithSingleElement": true,
                    "optional": true,
                    "targetPath": "$.members[*].type"
                }
            ]
        }
    },
    "gitFetchAllowed": false
}